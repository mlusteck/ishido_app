<% if @game %>
  <div class="board">
  <% 8.times do |board_y| %>
    <% 12.times do |board_x| %>
      <% stone = @game.get_stone(board_x, board_y) %>
      <% if stone["color"] != 0 %>
        <div class="board-square"><span class='stone symbol<%= stone["symbol"] %>
                    color<%= stone["color"] %>' ><%= stone["symbol"] %></span></div>
      <% else %>
        <% fit_count = @game.current_stone_fit_count(board_x, board_y) %>
        <% if fit_count == 0 %>
          <div class="board-square"><span class='stone' ><%= stone["symbol"] %></span></div>
        <% else %>
          <div class="board-square"><span class='stone place-stone'
                data-board-x='<%= board_x %>'
                data-board-y='<%= board_y %>'><%= "\u25cf" %></span></div>
        <% end %>
      <% end %>
    <% end %>
    <div style="clear: both;"></div>
  <% end %>
</div><!-- end board -->
<% end %>

<% content_for :aside do %>
  <% if @game %>
    <p>
      <ul>
        <li><span class="score"><%= @game.score %>123456</span> &nbsp; points</li>
        <li><span class="score"><%= @game.four_count %></span> &nbsp; four-ways</li>
        <li><span class="score"><%= 72 - @game.current_stone_id %></span> &nbsp;
                  stone<%= 's' if @game.current_stone_id != 71 %> left</li>
      </ul>
    </p>
    <% if stone = @game.get_current_stone %>
       <div class="next-square">
         <span class='stone symbol<%= stone["symbol"] %> color<%= stone["color"] %>' ><%= stone["symbol"] %></span>
       </div>
    <% end %>
    <p>
      <%= form_tag( games_path + "/" + @game.id.to_s + "/undo", method: :put ) do %>
        <%= submit_tag "Undo last move" %>
      <% end %>
      <%= form_tag( games_path + "/" + @game.id.to_s + "/set_stone", method: :put, class:"hidden-form") do %>
        <input type="hidden" id="board_x" name="board_x" value="2" />
        <input type="hidden" id="board_y" name="board_y" value="2" />
        <%= submit_tag "Set stone" %>
      <% end %>
    </p>
  <% end %>
<% end %>
